---
// src/components/TourCard.astro

type TourKind = "standard" | "custom" | "package" | string;

interface Props {
  title: string;
  teaser?: string;
  duration?: string;
  priceNumber?: number; // e.g., 39 -> "$39 per person"
  scheduleText?: string; // e.g., "Daily 9am & 1pm"
  thumbnailSrc?: string;
  href?: string; // details page
  bookingUrl?: string; // direct booking
  formUrl?: string; // request form (for custom/packages)
  kind?: TourKind;
  ctaLabel?: string; // optional override
}

const { title, teaser, duration, priceNumber, scheduleText, thumbnailSrc, href, bookingUrl, formUrl, kind, ctaLabel } =
  Astro.props as Props;

function formatPrice(n?: number) {
  if (n == null) return "";
  return `$${n} per person`;
}

const ctaHref = bookingUrl ?? formUrl ?? href ?? "#";
const ctaText = ctaLabel ?? (bookingUrl ? "Book Now" : formUrl ? "Request Info" : "See Details");
---

<article class="flex flex-col overflow-hidden rounded-2xl border bg-white shadow-sm">
  {
    thumbnailSrc && (
      <a href={href ?? ctaHref} class="block">
        <img src={thumbnailSrc} alt="" class="h-48 w-full object-cover" loading="lazy" decoding="async" />
      </a>
    )
  }

  <div class="flex flex-1 flex-col gap-4 p-5">
    <header class="flex items-start justify-between gap-3">
      <h3 class="text-lg font-semibold tracking-tight">
        {
          href ? (
            <a href={href} class="hover:underline">
              {title}
            </a>
          ) : (
            title
          )
        }
      </h3>
      <!-- {
        kind && (
          <span class="shrink-0 rounded-full border px-2 py-0.5 text-xs font-medium text-slate-700">
            {kind === "standard" ? "Standard" : kind === "custom" ? "Custom" : "Package"}
          </span>
        )
      } -->
    </header>

    {teaser && <p class="text-slate-600 text-sm">{teaser}</p>}

    <dl class="mt-auto grid grid-cols-1 gap-2 text-sm text-slate-700 sm:grid-cols-2">
      {
        duration && (
          <div>
            <dt class="sr-only">Duration</dt>
            <dd>‚è± {duration}</dd>
          </div>
        )
      }
      {
        scheduleText && (
          <div>
            <dt class="sr-only">Schedule</dt>
            <dd>üóì {scheduleText}</dd>
          </div>
        )
      }
      {
        priceNumber != null && (
          <div class="sm:col-span-2">
            <dt class="sr-only">Price</dt>
            <dd class="font-medium">{formatPrice(priceNumber)}</dd>
          </div>
        )
      }
    </dl>

    <div class="pt-1">
      <a href={ctaHref} class="btn btn-primary">
        {ctaText}
      </a>
    </div>
  </div>
</article>
